<extend name="Public/base" />
<block name="style"></block>

<block name="body">
	<div class="page-head">
		<h2>财务管理-退款数据上传</h2>
	</div>
	<div class="cl-mcont">
		<div class="row">
			<div class="col-md-12">
				<div class="block-flat">
					<div class="header">
						<h3 class="hthin">{$meta_title}</h3>
					</div>
					<div class="content">
						<div class="col-sm-12" style="margin-bottom: 10px;">
							<div class="col-sm-4 form-inline">
								<label class="" for="platform">支付平台</label>
                                <select class="form-control" id="platform" name="platform" onchange="" value="{$Think.get.platform|default=''}">
                                    <option value="" >全部商品</option>
                                    <volist name="paytype_list" id="vo">
                                        <option value="{$vo.platform}">{$vo.platform}</option>
                                    </volist>
                                </select>
							</div>
							<div class="col-sm-4 form-inline">
                                <label class="" for="keyword">支付平台流水号/订单号</label>
								<input type="text" id="keyword" name="keyword" class="form-control" value="{$Think.get.keyword|default=''}" width="100%" placeholder="支付平台流水号/订单号" />
							</div>
						</div>
						<div class="clearfix"></div>
						<div class="col-sm-12">
							<div style="float: left;width: 100%;">
								<label class="pull-left control-label">开始日期</label>
								<div class="col-sm-3">
									<div class="input-group date starttime" data-min-view="2" data-date-format="yyyy-mm-dd">
										<input type="text" id="starttime" name="starttime" class="form-control" value="{$Think.get.starttime|default=''}" />
										<span class="input-group-addon btn btn-primary"> <span class="glyphicon glyphicon-th"></span></span>
									</div>
								</div>
								<label class="pull-left control-label">结束日期</label>
								<div class="col-sm-3">
									<div class="input-group date endtime" data-min-view="2" data-date-format="yyyy-mm-dd">
										<input type="text" id="endtime" name="endtime" class="form-control" value="{$Think.get.endtime|default=''}" />
										<span class="input-group-addon btn btn-primary"><span class="glyphicon glyphicon-th"></span></span>
									</div>
								</div>
								<div class="col-sm-4">
									<button type="button" id="search" url="{:U('')}" class="btn btn-success">搜索</button>
                                    <a type="button" id="import" href="{:U('refundimport')}" class="btn btn-success">导入</a>
									<button type="button" id="export" url="{:U('refundexport')}" class="btn btn-success">导出</button>
								</div>
							</div>
						</div>
						<table class="no-border blue">
							<thead class="no-border">
								<tr>
									<th style="width:auto;">退款时间</th>
									<th style="width:auto;">支付平台</th>
									<th style="width:auto;">支付平台流水号</th>
									<th style="width:auto;color:green;">订单号</th>
									<th style="width:auto;">退款金额</th>
								</tr>

							</thead>
							<notempty name="list">
								<tbody class="no-border-y">
									<volist name="list" id="vo">
										<tr>
											<td style="width:auto;">{$vo.refund_time|date="Y/m/d H:i:s",###}</td>
											<td style="width:auto;">{$vo.platform}</td>
											<td style="width:auto;">{$vo.platform_order_no}</td>
											<td style="width:auto;color:green;">{$vo.order_id}</td>
											<td style="width:auto;">{$vo.refund_amount}</td>
										</tr>
									</volist>
								</tbody>
								<else/>
								<td colspan="4"> aOh! 暂时还没有内容! </td>
							</notempty>
						</table>
						<div class="content col-lg-12 pull-left">
							<div class="panel-foot text-center">
								<div class="page">{$_page}</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</block>

<block name="script">
	<js href="__JS__/jquery.icheck/icheck.min.js" />
	<js href="__JS__/bootstrap.datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js" />
	<script type="text/javascript">
        $(document).ready(function() {
            highlight_subnav("{:U('Finance/refund')}");

            $(".starttime").datetimepicker({autoclose: true,language: 'zh-CN'});
			$(".endtime").datetimepicker({autoclose: true,language: 'zh-CN'});

            //搜索功能
			$("#search").click(function () {
				var url = $(this).attr('url');
                var platform= $('#platform').val()==""?"": encodeURIComponent($('#platform').val());
				var starttime= $('#starttime').val();
				var endtime= $('#endtime').val();
                var keyword= $('#keyword').val();
				var query="keyword/"+keyword+"/platform/"+ platform+"/starttime/"+starttime+"/endtime/"+endtime;
				url += '/' + query;
				window.location.href = url;
			});

            $("#export").on('click',function(){
                var url = $(this).attr('url');
                var platform= $('#platform').val()==""?"": encodeURIComponent($('#platform').val());
				var starttime= $('#starttime').val();
				var endtime= $('#endtime').val();
                var keyword= $('#keyword').val();
				var query="keyword/"+keyword+"/platform/"+ platform+"/starttime/"+starttime+"/endtime/"+endtime;
				url += '/' + query;
				window.location.href = url;
            });

            $('#platform').val('{$Think.get.platform}')
        });
    </script>
</block>